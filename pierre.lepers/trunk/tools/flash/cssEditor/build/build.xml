<?xml version="1.0" encoding="UTF-8"?>
<!-- ====================================================================== 
     23 mars 2009 15:24:37                                                        

     Digitas Ant Tasks    
     build digitas ant tasks
                   
     lepersp                                                                
     ====================================================================== -->
<project name="Digitas Fmk - CSS Editor" default="main" basedir="../../../../">
	<description>
            build digitas ant tasks
    </description>

	<property name="FMK_HOME" location="${basedir}" />
	<loadproperties srcfile="${basedir}/build.config" />
	<loadproperties srcfile="${basedir}/.properties" />

	<!-- ================================= 
          target: main              
         ================================= -->
	<target name="main" depends="init" description="build CSS Editor">
		<antcall target="clean" />
		<antcall target="prepare" />
		<antcall target="compile" />
		<antcall target="package" />
	</target>



	<!-- - - - - - - - - - - - - - - - - - 
          target: clean                      
         - - - - - - - - - - - - - - - - - -->
	<target name="clean">

	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: prepare                      
         - - - - - - - - - - - - - - - - - -->
	<target name="prepare">
		<exec executable="${digitas.amxmlc}">
			<arg line="-debug=true" />
			<arg line="-sp ${projectDir}/src" />
			<arg line="-l ${digitas.dir.fmk}/bin/fp9/flowearth.swc" />
			<arg line="-external-library-path+=${projectDir}/swc/assets.swc" />
			<arg line="-o ${projectDir}/deploy/fontSandbox.swf" />
			<arg line="-link-report ${projectDir}/deploy/fontSandbox_report.xml" />
			<arg line="-- ${projectDir}/src/fr/digitas/flowearth/csseditor/fonts/FontSandbox.as" />
		</exec>
		
		<copy file="${projectDir}/deploy/fontSandbox.swf" tofile="C:/Documents and Settings/pierre/Application Data/fr.digitas.flowearth.cssEditor/Local Store/fontSandbox.swf"></copy>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: compile                      
         - - - - - - - - - - - - - - - - - -->
	<target name="compile">
		<exec executable="${digitas.amxmlc}">
			<arg line="-debug=true" />
			<arg line="-sp ${projectDir}/offline" />
			<arg line="-sp ${projectDir}/src" />
			<arg line="-l ${digitas.dir.fmk}/bin/fp9/flowearth.swc" />
			<arg line="-l ${projectDir}/swc/assets.swc" />
			<arg line="-o ${projectDir}/deploy/cssEditor.swf" />
			<arg line="-- ${projectDir}/src/fr/digitas/flowearth/csseditor/Main.as" />
		</exec>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: package                      
         - - - - - - - - - - - - - - - - - -->
	<target name="package" depends="certificate">
		<exec executable="${digitas.adt}" dir="${projectDir}">
			
			<arg line="-package -storetype pkcs12 -keystore build/certificate.p12 -storepass 39#wnetx3tl install/CssEditor.air build/descriptor.xml deploy/cssEditor.swf" />
			<!--
			<arg value="-package" />
			
			<arg value="-storetype" />
			<arg value="pkcs12" />
			
			<arg value="-keystore" />
			<arg value="build/certificate.p12" />
			
			<arg value="CssEditor.air" />
			<arg value="build/descriptor.xml" />
			-->
		</exec>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: certificate                      
         - - - - - - - - - - - - - - - - - -->
	<target name="certificate">
		<exec executable="${digitas.adt}" dir="${projectDir}">
			<arg value="-certificate" />
			
			<arg value="-cn" />
			<arg value="cssEditorCert" />
			
			<arg value="2048-RSA" />
			<arg value="build/certificate.p12" />
			<arg value="39#wnetx3tl" />
		</exec>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: launch                      
         - - - - - - - - - - - - - - - - - -->
	<target name="launch" depends="init,compile">
		<exec executable="${digitas.adl}" dir="${projectDir}">
			<arg line="build/descriptor.xml ${projectDir}/" />
		</exec>
	</target>



	<!-- - - - - - - - - - - - - - - - - - 
          target: init                      
         - - - - - - - - - - - - - - - - - -->
	<target name="init">
		<loadproperties srcfile="${digitas.dir.antTasks}/build/build.properties" />
		<property name="projectDir" value="${basedir}/tools/flash/cssEditor" />
		<property name="APP_NAME" value="CssEditor"/> 

	</target>

</project>
