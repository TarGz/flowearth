<?xml version="1.0" encoding="UTF-8"?>
<!-- ====================================================================== 
     23 mars 2009 15:24:37                                                        

     Digitas Ant Tasks    
     build digitas ant tasks
                   
     lepersp                                                                
     ====================================================================== -->
<project name="Digitas Fmk - CSS Editor" default="main" basedir="../../../../">
	<description>
            build digitas ant tasks
    </description>

	<property name="FMK_HOME" location="${basedir}" />
	<loadproperties srcfile="${basedir}/build.config" />
	<loadproperties srcfile="${basedir}/.properties" />
	
	<taskdef resource="digitasAnt.tasks"
		         classpath="${FMK_HOME}/tools/ant/tasks/bin/digitasAntTasks.jar" />

	<!-- ================================= 
          target: main              
         ================================= -->
	<target name="main" depends="init" description="build CSS Editor">
		<antcall target="clean" />
		<antcall target="prepare" />
		<antcall target="compile" />
		<antcall target="compile_online" />
		<antcall target="package" />
	</target>



	<!-- - - - - - - - - - - - - - - - - - 
          target: clean                      
         - - - - - - - - - - - - - - - - - -->
	<target name="clean">

	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: prepare                      
         - - - - - - - - - - - - - - - - - -->
	<target name="prepare">
		<exec executable="${digitas.amxmlc}">
			<arg line="-debug=${DEBUG}" />
			<arg line='-define+=CONFIG::sandboxnum,"0"' />
			<arg line="-use-network=false" />
			<arg line="-sp ${projectDir}/src" />
			<arg line="-l ${digitas.dir.fmk}/bin/fp9/flowearth.swc" />
			<arg line="-o ${projectDir}/deploy/fontSandbox0.swf" />
			<arg line="-link-report ${projectDir}/deploy/fontSandbox_report.xml" />
			<arg line="-- ${projectDir}/src/fr/digitas/flowearth/csseditor/fonts/FontSandbox.as" />
		</exec>
		<exec executable="${digitas.amxmlc}">
			<arg line="-debug=${DEBUG}" />
			<arg line='-define+=CONFIG::sandboxnum,"1"' />
			<arg line="-use-network=false" />
			<arg line="-sp ${projectDir}/src" />
			<arg line="-l ${digitas.dir.fmk}/bin/fp9/flowearth.swc" />
			<arg line="-o ${projectDir}/deploy/fontSandbox1.swf" />
			<arg line="-link-report ${projectDir}/deploy/fontSandbox_report.xml" />
			<arg line="-- ${projectDir}/src/fr/digitas/flowearth/csseditor/fonts/FontSandbox.as" />
		</exec>
		<exec executable="${digitas.amxmlc}">
			<arg line="-debug=${DEBUG}" />
			<arg line='-define+=CONFIG::sandboxnum,"2"' />
			<arg line="-use-network=false" />
			<arg line="-sp ${projectDir}/src" />
			<arg line="-l ${digitas.dir.fmk}/bin/fp9/flowearth.swc" />
			<arg line="-o ${projectDir}/deploy/fontSandbox2.swf" />
			<arg line="-link-report ${projectDir}/deploy/fontSandbox_report.xml" />
			<arg line="-- ${projectDir}/src/fr/digitas/flowearth/csseditor/fonts/FontSandbox.as" />
		</exec>
		<exec executable="${digitas.amxmlc}">
			<arg line="-debug=${DEBUG}" />
			<arg line='-define+=CONFIG::sandboxnum,"3"' />
			<arg line="-use-network=false" />
			<arg line="-sp ${projectDir}/src" />
			<arg line="-l ${digitas.dir.fmk}/bin/fp9/flowearth.swc" />
			<arg line="-o ${projectDir}/deploy/fontSandbox3.swf" />
			<arg line="-link-report ${projectDir}/deploy/fontSandbox_report.xml" />
			<arg line="-- ${projectDir}/src/fr/digitas/flowearth/csseditor/fonts/FontSandbox.as" />
		</exec>
		
		<copy file="${projectDir}/deploy/fontSandbox0.swf" tofile="${projectDir}/deploy/fontSandbox0.swf"></copy>
		<copy file="${projectDir}/deploy/fontSandbox1.swf" tofile="${projectDir}/deploy/fontSandbox1.swf"></copy>
		<copy file="${projectDir}/deploy/fontSandbox2.swf" tofile="${projectDir}/deploy/fontSandbox2.swf"></copy>
		<copy file="${projectDir}/deploy/fontSandbox3.swf" tofile="${projectDir}/deploy/fontSandbox3.swf"></copy>
		
		<!--copy file="${projectDir}/deploy/fontSandbox0.swf" tofile="D:/Documents and Settings/lepersp/Application Data/fr.digitas.flowearth.cssEditor/Local Store/deploy/fontSandbox0.swf"></copy>
		<copy file="${projectDir}/deploy/fontSandbox1.swf" tofile="D:/Documents and Settings/lepersp/Application Data/fr.digitas.flowearth.cssEditor/Local Store/deploy/fontSandbox1.swf"></copy>
		<copy file="${projectDir}/deploy/fontSandbox2.swf" tofile="D:/Documents and Settings/lepersp/Application Data/fr.digitas.flowearth.cssEditor/Local Store/deploy/fontSandbox2.swf"></copy>
		<copy file="${projectDir}/deploy/fontSandbox3.swf" tofile="D:/Documents and Settings/lepersp/Application Data/fr.digitas.flowearth.cssEditor/Local Store/deploy/fontSandbox3.swf"></copy-->
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: compile                      
         - - - - - - - - - - - - - - - - - -->
	<target name="compile">
		<exec executable="${digitas.amxmlc}">
			<arg line="-debug=${DEBUG}" />
			<arg line="-use-network=false" />
			<arg line="-sp ${projectDir}/offline" />
			<arg line="-sp ${projectDir}/src" />
			<arg line="-l ${digitas.dir.fmk}/bin/fp9/flowearth.swc" />
			<arg line="-l ${projectDir}/swc/assets.swc" />
			<arg line="-o ${projectDir}/deploy/cssEditor.swf" />
			<arg line="-- ${projectDir}/src/fr/digitas/flowearth/csseditor/Main.as" />
		</exec>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: compile_online                    
         - - - - - - - - - - - - - - - - - -->
	<target name="compile_online" depends="init">
		<exec executable="${digitas.mxmlc}">
			<arg line="-debug=${DEBUG}" />
			<arg line="-use-network=false" />
			<arg line="-sp ${projectDir}/online" />
			<arg line="-sp ${projectDir}/src" />
			<arg line="-l ${digitas.dir.fmk}/bin/fp9/flowearth.swc" />
			<arg line="-l ${projectDir}/swc/assets.swc" />
			<arg line="-o ${projectDir}/deploy/cssEditor_online.swf" />
			<arg line="-- ${projectDir}/src/fr/digitas/flowearth/csseditor/Main.as" />
		</exec>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: package                      
         - - - - - - - - - - - - - - - - - -->
	<target name="package" depends="certificate">
		<exec executable="${digitas.adt}" dir="${projectDir}">
			
			<!--arg line="-package -storetype pkcs12 -keystore build/certificate.p12 -storepass 39#wnetx3tl install/CssEditor.air build/descriptor.xml deploy/cssEditor.swf" /-->
			
			<arg value="-package" />
			
			<arg value="-storetype" />
			<arg value="pkcs12" />
			
			<arg value="-keystore" />
			<arg value="build/certificate.p12" />

			<arg value="-storepass" />
			<arg value="39#wnetx3tl" />
			
			<arg value="install/CssEditor.air" />
			<arg value="build/descriptor.xml" />

			<arg value="deploy" />
			
		</exec>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: certificate                      
         - - - - - - - - - - - - - - - - - -->
	<target name="certificate">
		<exec executable="${digitas.adt}" dir="${projectDir}">
			<arg value="-certificate" />
			
			<arg value="-cn" />
			<arg value="cssEditorCert" />
			
			<arg value="2048-RSA" />
			<arg value="build/certificate.p12" />
			<arg value="39#wnetx3tl" />
		</exec>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: launch                      
         - - - - - - - - - - - - - - - - - -->
	<target name="launch" depends="init,compile">
		<exec executable="${digitas.adl}" dir="${projectDir}">
			<arg line="build/descriptor.xml ${projectDir}/" />
		</exec>
	</target>

	<!-- - - - - - - - - - - - - - - - - - 
          target: fontTest                      
         - - - - - - - - - - - - - - - - - -->
    <target name="fonttest" depends="init">
    	<createFont classname="cssEditorFontTest_1"
		            swf="${projectDir}/test/fonts/fonts_1.swf"
		            compiler="${digitas.mxmlc}"
		            keepgenerated="true">

			<font fontfamily="FontA"
			      fontweight="normal"
			      sourcefile="${projectDir}/test/fonts/GillSans-Light.otf"
			      unicoderange="U+0020-U+00ff" />

			


			<arg line="-use-network=false" />

		</createFont>

    	<createFont classname="cssEditorFontTest_2"
		            swf="${projectDir}/test/fonts/fonts_2.swf"
		            compiler="${digitas.mxmlc}"
		            keepgenerated="true">

			<font fontfamily="FontA"
			      fontweight="normal"
			      sourcefile="${projectDir}/test/fonts/HelveticaNeueLTStd-XBlkCn.otf"
			      chars="ABCabc" />

			


			<arg line="-use-network=false" />

		</createFont>

    	<property name="fr_range" value="U+0020-U+00ff"/>
    	<createFont classname="cssEditorFontTest_FranklinFr"
		            swf="${projectDir}/test/fonts/franklin_Fr.swf"
		            compiler="${digitas.mxmlc}"
		            keepgenerated="true">
    		
    		<!-- 
    		
			      sourcefile="${projectDir}/test/fonts/Frabk.TTF"
			      sourcefile="${projectDir}/test/fonts/Frabkit.TTF"
			      sourcefile="${projectDir}/test/fonts/Frabk.TTF"
			      sourcefile="${projectDir}/test/fonts/Frabkit.TTF"
    		-->
			<font fontfamily="FranklinBook"
			      fontweight="normal"
			      sourcename="Franklin Gothic Book"
			      unicoderange="${fr_range}" />

    		<font fontfamily="FranklinBook"
			      fontweight="normal"
			      fontstyle="italic"
			      sourcename="Franklin Gothic Book"
			      unicoderange="${fr_range}" />

    		<font fontfamily="FranklinBook"
			      fontweight="bold"
			      sourcename="Franklin Gothic Book"
			      unicoderange="${fr_range}" />

    		<font fontfamily="FranklinBook"
			      fontweight="bold"
			      fontstyle="italic"
			      sourcename="Franklin Gothic Book"
			      unicoderange="${fr_range}" />

			


			<arg line="-use-network=false" />

		</createFont>
    </target>


	<!-- - - - - - - - - - - - - - - - - - 
          target: init                      
         - - - - - - - - - - - - - - - - - -->
	<target name="init">
		<loadproperties srcfile="${digitas.dir.antTasks}/build/build.properties" />
		<property name="projectDir" value="${basedir}/tools/flash/cssEditor" />
		<property name="APP_NAME" value="CssEditor"/> 
		<property name="DEBUG" value="true"/> 

	</target>

</project>
